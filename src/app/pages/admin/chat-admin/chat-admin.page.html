<ion-header>
  <ion-toolbar color="tertiary"> <ion-buttons slot="start">
      <ion-back-button defaultHref="/chat-list"></ion-back-button>
    </ion-buttons>
    <ion-title>
      Chat con {{ clientePerfil?.email || 'Cliente' }}
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  
  <div *ngFor="let msg of mensajes" [class]="msg.es_asesor ? 'mensaje-propio' : 'mensaje-cliente'">
    <div class="burbuja">
      {{ msg.contenido }}
    </div>
    <small>{{ msg.created_at | date:'shortTime' }}</small>
  </div>

  <div *ngIf="clienteEscribiendo" class="typing-indicator">
    <p>El cliente est√° escribiendo...</p>
  </div>

</ion-content>

<ion-footer>
  <ion-toolbar>
    <ion-item lines="none">
      <ion-input 
        [(ngModel)]="nuevoMensaje" 
        (ionInput)="onTyping()" 
        placeholder="Escribe una respuesta..."
        (keyup.enter)="enviar()">
      </ion-input>
      <ion-button (click)="enviar()" slot="end" fill="clear">
        <ion-icon name="send" slot="icon-only" color="tertiary"></ion-icon>
      </ion-button>
    </ion-item>
  </ion-toolbar>
</ion-footer>